{% extends "includes/base-card.html" %}
{% load static %}
{% block card-header %}
Malware Domain Analysis
{% endblock %}
{% block card-body %}
{% comment %} <div class="card card-body mx-3 mx-md-4 mt-n6"> {% endcomment %}
  <div class="row gx-4 mb-2">
  <div class="table-responsive mb-4">
    
    <table class="table-striped align-items-center mb-4">
      <thead>
        <tr>
          <th class="col-12 col-xl-1 text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 p-2">Domain</th>
          <th class="col-12 col-xl-1 text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Status</th>
          <th class="col-12 col-xl-3 text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Geolocation</th>
        </tr>
      </thead>
      <tbody>
        {% for domain, details in domains.items %}
        <tr><td>{{domain}}</td><td> 

          {% if details|key:"bad" == "yes" %}
          <span class="badge bg-danger">malware</span><br/>
            <pre>
            <strong>URL: </strong>{{details|key:"domain_or_url"}}
            <strong>IP: </strong><span class="badge bg-danger">{{details|key:"ip"}}</span>
            <strong>Description: </strong>{{details|key:"desc"}}
            </pre>
        {% else %}
          <span class="badge bg-success">ok</span><br/>
        {% endif %}
        </td>
        <td>
          {% if details|key:"geolocation" %}
            <strong>IP: </strong>{{details|key:"geolocation"|key:"ip"}}  <br/>
            <strong>Country: </strong>{{details|key:"geolocation"|key:"country_long"}} <br/>
            <strong>Region: </strong>{{details|key:"geolocation"|key:"region"}} <br/>
            <strong>City: </strong>{{details|key:"geolocation"|key:"city"}} <br/>
            <strong>Latitude: </strong>{{details|key:"geolocation"|key:"latitude"}} <br/>
            <strong>Longitude: </strong>{{details|key:"geolocation"|key:"longitude"}} <br/>
            <strong>View: <a target="_blank" href="http://maps.google.com/maps?q={{details|key:"geolocation"|key:"latitude"}},{{details|key:"geolocation"|key:"longitude"}}">Google Map</a>
          {% else %}
          No Geolocation information available.
          {% endif %}
        </td>
        </tr>
        {% endfor %}
        
      </tbody>
    </table>
  </div>
  </div>
{% comment %} </div> {% endcomment %}
{% endblock %}